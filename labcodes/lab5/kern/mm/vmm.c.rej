--- kern/mm/vmm.c	2021-02-07 16:11:21.000000000 +0800
+++ kern/mm/vmm.c	2021-12-22 21:40:35.000000000 +0800
@@ -389,6 +392,14 @@
                                     //    into the memory which page managed.
                                     //(2) According to the mm, addr AND page, setup the map of phy addr <---> logical addr
                                     //(3) make the page swappable.
+            if ((ret = swap_in(mm, addr, &page)) != 0)
+            {
+                cprintf("swap_in in do_pgfault failed\n");
+                goto failed;
+            }
+            page_insert(mm->pgdir, page, addr, perm);
+            swap_map_swappable(mm, addr, page, 1);
+            page->pra_vaddr = addr;
         }
         else {
             cprintf("no swap_init_ok but ptep is %x, failed\n",*ptep);
